<!DOCTYPE html>
<html>
<head>
	<title>HashPay</title>
	<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=0;" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
	<link rel="stylesheet" type="text/css" href="style.css">
	<style>
        body {
            font-family: courier, serif;
            text-align: center;
            background-color: white;
            margin: 0;
            padding: 0;
        }

        #header {
            background-color: white;
            color: #fff;
            padding: 20px;
        }

        h1 {
            font-size: 2.5em;
            margin: 0;
        }

        .logo {
            width: 100px;
        }

        #content {
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            margin: 20px;
        }

        h2 {
            font-size: 1.5em;
            color: rgba(206, 179, 255, 0.8);
        }

        .balance {
            font-size: 2em;
            margin: 20px;
        }

        .input-group {
            margin: 20px 0;
        }

        label {
            display: block;
            font-size: 1.2em;
            color: rgba(206, 179, 255, 0.8);
        }

        input[type="text"],
        input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        input[type="submit"] {
            background-color: rgba(206, 179, 255, 0.8);
            color: black;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.2em;
        }

        input[type="submit"]:hover {
            background-color: ;
        }

        #footer {
            background-color: white;
            color: black;
            padding: 10px;
        }

        .disclaimer {
            font-size: 0.8em;
            margin: 10px;
        }
    </style>
	<script>
		function updateBalance() {
			var balance = parseInt(localStorage.getItem("balance"));
			if (isNaN(balance)) {
				balance = 0;
				localStorage.setItem("balance", balance.toString());
			}
			var account = localStorage.getItem("account");
			if (!account) {
				account = generateAccount();
				localStorage.setItem("account", account);
			}
			document.getElementById("balance").innerHTML = balance;
			document.getElementById("account").innerHTML = account;
		}

		function generateAccount() {
			var account = "";
			var characters = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
			for (var i = 0; i < 10; i++) {
				account += characters.charAt(Math.floor(Math.random() * characters.length));
			}
			return account;
		}

		function validateHashcash() {
			var hashcash = document.getElementById("hashcash").value;
			var balance = parseInt(localStorage.getItem("balance"));
			if (isNaN(balance)) {
				balance = 0;
				localStorage.setItem("balance", balance.toString());
			}
			var account = localStorage.getItem("account");
			if (!account) {
				account = generateAccount();
				localStorage.setItem("account", account);
			}
			var regex = /^1:(\d+):sha256:(.*):(.*)::(\d+):(\d+)$/;
			var matches = hashcash.match(regex);
			if (!matches || matches.length != 6) {
				alert("Invalid hashcash format.");
				return;
			}
			var timestamp = parseInt(matches[1]);
			var message = matches[2];
			var recipient = matches[3];
			var value = parseInt(matches[4]);
			var nonce = parseInt(matches[5]);
			var hashcashData = "1:" + timestamp + ":sha256:" + message + ":" + recipient + "::" + value + ":" + nonce;
			var hash = CryptoJS.SHA256(hashcashData).toString();
			if (hash.substr(0, 5) !== "00000") {
				alert("Invalid hashcash nonce.");
				return;
			}
			if (recipient !== account) {
				alert("Invalid recipient account.");
				return;
			}

			// Check if hashcash has already been redeemed
			var redeemedHashes = localStorage.getItem("redeemedHashes");
			if (redeemedHashes && redeemedHashes.indexOf(hashcash) !== -1) {
				alert("This hashpay cash has already been redeemed.");
				return;
			}

			// Add hashcash value to balance and save hashcash to redeemedHashes
			balance += value;
			localStorage.setItem("balance", balance.toString());
			updateBalance();

			if (!redeemedHashes) {
				redeemedHashes = hashcash;
			} else {
				redeemedHashes += "|" + hashcash;
			}
			localStorage.setItem("redeemedHashes", redeemedHashes);
			alert("HashPay Cash validated and " + value + " added to your balance.");
		}

		window.onload = function() {
			updateBalance();
		};
	</script>
</head>
<body>
	<p>Account number: <span id="account"></span> <button onclick="copyAccountNumber()">Copy</button></p>

<!-- JavaScript function to copy the account number to the clipboard -->
<script>
  function copyAccountNumber() {
    var accountNumber = document.getElementById("account").textContent;
    
    // Create a temporary input element to hold the account number
    var tempInput = document.createElement("input");
    tempInput.value = accountNumber;
    
    // Append the input element to the document
    document.body.appendChild(tempInput);
    
    // Select the text in the input element
    tempInput.select();
    
    // Copy the selected text to the clipboard
    document.execCommand("copy");
    
    // Remove the temporary input element
    document.body.removeChild(tempInput);
    
    // Provide feedback to the user
    alert("Account number copied: " + accountNumber);
  }
</script>
	<div id="content">
	<div class="balance">â±£<b><span id="balance"></span></b></div>
	</div>
</body>
</html>
